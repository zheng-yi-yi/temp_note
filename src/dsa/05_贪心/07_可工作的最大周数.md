---
title: 可工作的最大周数
category: 算法
tag:
  - 贪心
order: 7
icon: solar:widget-line-duotone
---

## [题目描述](https://leetcode.cn/problems/maximum-number-of-weeks-for-which-you-can-work/)

给你 `n` 个项目，编号从 `0` 到 `n - 1` 。同时给你一个整数数组 `milestones` ，其中每个 `milestones[i]` 表示第 `i` 个项目中的阶段任务数量。

你可以按下面两个规则参与项目中的工作：

- 每周，你将会完成 **某一个** 项目中的 **恰好一个** 阶段任务。你每周都 **必须** 工作。
- 在 **连续的** 两周中，你 **不能** 参与并完成同一个项目中的两个阶段任务。

一旦所有项目中的全部阶段任务都完成，或者仅剩余一个阶段任务都会导致你违反上面的规则，那么你将 **停止工作** 。注意，由于这些条件的限制，你可能无法完成所有阶段任务。

返回在不违反上面规则的情况下你 **最多** 能工作多少周。

**示例 1：**

```
输入：milestones = [1,2,3]
输出：6
解释：一种可能的情形是：
- 第 1 周，你参与并完成项目 0 中的一个阶段任务。
- 第 2 周，你参与并完成项目 2 中的一个阶段任务。
- 第 3 周，你参与并完成项目 1 中的一个阶段任务。
- 第 4 周，你参与并完成项目 2 中的一个阶段任务。
- 第 5 周，你参与并完成项目 1 中的一个阶段任务。
- 第 6 周，你参与并完成项目 2 中的一个阶段任务。
总周数是 6 。
```

**示例 2：**

```
输入：milestones = [5,2,1]
输出：7
解释：一种可能的情形是：
- 第 1 周，你参与并完成项目 0 中的一个阶段任务。
- 第 2 周，你参与并完成项目 1 中的一个阶段任务。
- 第 3 周，你参与并完成项目 0 中的一个阶段任务。
- 第 4 周，你参与并完成项目 1 中的一个阶段任务。
- 第 5 周，你参与并完成项目 0 中的一个阶段任务。
- 第 6 周，你参与并完成项目 2 中的一个阶段任务。
- 第 7 周，你参与并完成项目 0 中的一个阶段任务。
总周数是 7 。
注意，你不能在第 8 周参与完成项目 0 中的最后一个阶段任务，因为这会违反规则。
因此，项目 0 中会有一个阶段任务维持未完成状态。
```

**提示：**

- `n == milestones.length`
- `1 <= n <= 10^5`
- `1 <= milestones[i] <= 10^9`

## 如何贪心

这里的贪心策略是，尽可能地平衡各个项目的工作量，以最大化可以工作的周数，实际上该问题等价为构造一个尽量长的，相邻项目元素不同的序列，并且每个项目`x`出现的次数不能超过`milestones[x]`。限制在于**不能在连续的两周中完成同一个项目的两个阶段任务**。

结论如下：

设 `milestones` 的元素和为 `sum` ，这是序列和的上界。设耗时最长的项目花费 `longest`周，其余工作都完成，则需要 `sum - longest` 周：

- 如果 `longest <= sum - longest + 1 `，则答案为 `sum`，此时我们可以完成所有的阶段任务，在每个项目中交替完成阶段任务，直到完成所有项目的所有阶段任务即可。

- 如果 `longest` > `sum - longest + 1 `，则答案为 `2 * (sum - longest) + 1`，因为此时无法完成所有的阶段任务，只能尽可能地在每个项目中交替完成阶段任务，直到完成除最长项目外的所有项目的所有阶段任务，然后再完成最长项目的一个阶段任务。

```java
class Solution {
    public long numberOfWeeks(int[] milestones) {
        long sum = 0, max = 0;
        for (int milestone : milestones) {
            sum += milestone;
            max = Math.max(max, milestone);
        }
        long rest = sum - max;
        if (max > rest + 1) {
            return rest * 2 + 1;
        } else {
            return sum;
        }
    }
}
```

